---
title: ドキュメントを書く
---

# 何故ドキュメントを書くのか？何を書くのか？
何を書くべきかを考える時はまず読む側の事を考えましょう。あなたが書いているコードは誰が使いますか？まずはあなたが使うはずです。ではあなたはコードを書いていて、ある標準ライブラリの使い方がすぐに思い出せなかったのでドキュメントを見に行くとしましょう。さてドキュメントを端から端まで読みますか？読まないはずです。とりあえず動けばいいので、サンプルコードをコピペして自分のコードに合うように直そうとして、やっぱり直し方が分からないとなったときに初めて文章を読み始めるでしょう。

あなたが書いたコードについてもこれが出来るようにドキュメントを書くべきです。よって大事なのはそのドキュメントがブラウザですぐ見れるようになっていることと、動作するサンプルコードがそこで見れることです。

# ドキュメントを生成する

Cargoで管理されているRustのプロジェクトでは

```shell
cargo doc
```

とすると `target/doc` 以下にドキュメントが生成されます。生成されたHTMLをブラウザで開くには`cargo doc --open`のように`--open`オプションをつけます。この時依存しているライブラリのドキュメントも一緒に生成するので、必要ない場合は `cargo doc --no-deps` とします。この時はcrateのメタデータに登録されているURLが参照されます。多くの場合はRustの公式チームの一つである[Docs.rs team](https://www.rust-lang.org/governance/teams/dev-tools#docs-rs)によって管理されている <https://docs.rs/> にホストされています。このサイトはRustの公式パッケージレジストリ <https://crates.io/> にパッケージがアップロードされると自動的にそのドキュメントを生成してホストしてくれます。

# サンプルコードを書く
まずはサンプルコードを書いていきましょう。例えば `cargo new --lib` で生成されるコードに対してサンプルコードを書いてみましょう：

```rust
/// ```rust
/// use document_example::add;
/// assert_eq!(add(1, 2), 3);
/// ```
pub fn add(left: usize, right: usize) -> usize {
    left + right
}
```

Rustにはいくつかコメントの種類がありますが、主に使うのは次の3つです

- `//` から始まる行コメント
- `///` から始まるドキュメントコメント
- `//!` から始まるモジュールドキュメントコメント

いずれも本体の実装に影響しないのは同じですが、後者二つはドキュメントに含まれます。ドキュメントコメントはMarkdown形式で記述します。\`\`\`で囲われている部分がサンプルコードになります。この時`cargo doc`でHTMLファイルを生成すると次のようになります：

![](https://storage.googleapis.com/zenn-user-upload/7a93168fe844-20230928.png)

:::message
残念ながら一般的にMarkdownと呼ばれる書式に共通の定義はなく処理系に応じて様々な独自の拡張があります。例えば[GitHub flavored Markdown](https://github.github.com/gfm/)やこの文章を記述している[ZennのMarkdown記法](https://zenn.dev/zenn/articles/markdown-guide)などがあります。Rustのドキュメントを処理する `rustdoc` は[CommonMark](https://commonmark.org/)に基づいています。
:::
