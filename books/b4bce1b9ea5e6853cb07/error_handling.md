---
title: エラーを管理する
---

Rustにおけるエラー処理については公式のドキュメントが非常によく書かれているので、そちらを参照することを強くお勧めします。

https://doc.rust-jp.rs/book-ja/ch09-00-error-handling.html

# 数値計算におけるエラー処理

数値計算と一言で言ってもどのように実行されるかは様々です。研究者が自分で書いたプログラムを自分の計算機上で実行する場合、例えば計算のためのパラメータファイルが見つからなかったらpanicして終了しても問題ないでしょう。一方ユーザーがCADデータをアップロードすると応力を解析してくれるウェブアプリケーションの場合にユーザーの提供したデータが応力の計算に必要な条件を満たさない場合、ユーザーにエラーメッセージを表示してファイルを修正して再度アップロードしてもらうことが望ましいでしょう。大型計算機で数日かかるような計算をするプログラムが何か計算が矛盾していることに気がついてそれ以上計算を続けることが不可能になったなら、その状況をもう一度計算しなくても良いように可能な限り詳細なレポートを生成してから終了したいはずです。このようにエラー処理の方法は状況によって異なります。

ソフトウェアというのは積み上げていくものなので、ある機能は他の高次の機能を実装するのに使われます。例えばあなたが[GMRES]や[BiCGStab]のような線型方程式の反復解法を実装したとすると、それは[Newton-Krylov法]やさらにそれを使って非線形最適化や分岐追跡ライブラリを作るのに使われるでしょう。

[BiCGStab]は行列の性質に応じて収束しないことがよくあります。[BiCGStab]の実装においては行列は所与なのでこれを変えるわけにはいかず、この関数にとってはどうしようもないのでエラーを返すことになります。これは行列の性質、特に固有値の分布のような静的にはわからない性質に依存しているのでエラーになるのかどうかは実行してみないと分かりません。

一方[Newton-Krylov法]のレイヤーで見ると[BiCGStab]が収束しないのはNewton法側のイテレーションによって点を移動させすぎたためで、[line search]や[trust region]等の減速法によって解決できるかもしれません。なので[BiCGStab]が返したエラーは[Newton-Krylov法]のレイヤーで処理することができる回復可能なエラーとなります。もちろんこれらの方法でエラーが回復できない場合は[Newton-Krylov法]の関数がエラーを返すことになります。同じことが非線形最適化や分岐追跡のようなレイヤーが増えるたびに繰り返されます。

[GMRES]: https://en.wikipedia.org/wiki/Generalized_minimal_residual_method
[BiCGStab]: https://en.wikipedia.org/wiki/Biconjugate_gradient_stabilized_method
[Newton-Krylov法]: https://en.wikipedia.org/wiki/Newton%E2%80%93Krylov_method
[line search]: https://en.wikipedia.org/wiki/Line_search
[trust region]: https://en.wikipedia.org/wiki/Trust_region

# エラー型の設計

