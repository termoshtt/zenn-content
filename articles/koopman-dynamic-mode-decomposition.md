---
title: "動的モード分解(DMD)とKoopman作用素"
emoji: "📦"
type: "idea"
topics: ["math"]
published: true
---

この記事では時系列解析の手法の一つである動的モード分解(Dynamic mode decomposition, DMD)をKoopman作用素との関係を中心に解説する。

状態空間モデル
------------
まず解析の前提となる設定についてまとめていく。この記事ではある一定の時間間隔($\Delta t$と書く)で、有限個(以降$N$とする)の実数値のデータが得られるシステムを考え、その挙動を解析したいとする。各時刻$t_i = i \Delta t$, $i = 0, \ldots, T$に対して得られるデータを$x_i \in \mathbb{R}^N$と書く。またシステムの状態を表す全ての変数を観測できるとは限らないので、各時刻$t_i$における真の状態を$z_i$と書き、そこから$x_i$を生成する過程を観測と呼び$x_i = H(z_i)$と書くことにしよう。観測に対応する関数$H$が$i$に依存しないのは観測の方法は時刻に依存しないことを意図している。

真の状態$z_i$がひとつ前の状態$z_{i-1}$によってだけ定まるシステムのことをマルコフ的であるという。この関係を$z_i = F(z_{i-1})$と書く。$f$を時間発展と呼び、これも時刻に依らないと仮定する。物理的な系においては時間発展は時間に関する微分方程式で与えられる(これを運動方程式と呼ぶ)事が多いが、適当な時間間隔について積分することでこの形になる。この$z_i$が属するノルム線形空間を$V$と書き状態空間と呼ぶことにしよう。これも時刻には依らない、あるいは全ての時刻について内包できるように$V$を取れると仮定する。さらに$F: V \to V$および$H: V \to \mathbb{R}^N$は連続であると仮定する。

Koopman作用素
-------------
時間発展$F: V \to V$を解析することが目的だが、これは非線形な関数なのでそのままだと解析が難しい。そこで少しテクニカルな方法で線形作用素のスペクトルに変換する。

状態空間$V$の値に対して実数値を与える連続関数全体

$$
X = \operatorname{Hom}(V, \mathbb{R}) = \lbrace f: V \to \mathbb{R}; \text{連続} \rbrace
$$

を考えると、これには$f, g \in X$とスカラー$a \in \mathbb{R}$に対して新しい関数$f + g, af \in X$を各$z \in V$に対して

$$
(f + g)(z) = f(z) + g(z), \space (af)(z) = a f(z)
$$

で定義することで線形空間となる。ある$f \in X$に対して、時間発展$F: V \to V$を右から作用させた関数$f \circ F$を考えるとこれは再び$X$の元になり、$f, g \in X$と$z \in V$について

$$
\begin{align*}
((f+g) \circ F)(z) &= (f+g)(F(z)) \\
& = f(F(z)) + g(F(z)) \\
&= (f \circ F)(z) + (g \circ F)(z) = (f \circ F + g \circ F)(z)
\end{align*}
$$

なので$f \mapsto f \circ F$は$X$の線形空間の構造について線形となり、この線形写像を$\Phi_F: X \to X$と書く。

動的モード分解
--------------
さて観測データ$x_i$から線形写像$\Phi_F$を回帰することを考えよう。

まず注意しないといけないのは$V$が有限次元であっても$X$は無限次元になることである。$\Phi_F$は$X$上の線形写像なので一般に行列では表現できず、なので計算機で表現できるとは限らない。数学的には$F$がどのような性質を持つときに適当な$\Phi_F$の近似が可能になるのかを考えるべきだが、応用上は$\Phi_F$をとりあえず適当な$X$の部分空間上で評価してみてどの程度$F$の情報を取り出せたのかを調べる。

$X$の部分空間の選び方として次のように観測データと上手く関係するようにとる。各時刻における状態が

$$
z_i = F(z_{i-1}) = \cdots = F^i(z_0)
$$

と書けることと、観測の第$j$成分に対応する関数$H_j: V \to \mathbb{R}$は$X$の元になるので時刻$i$の観測$x_i$の$j$成分が

$$
x_{ij} = (x_i)_j = H_j(z_i) = (H_j \circ F^i)(z_0) = (\Phi_F^i (H_j))(z_0)
$$

となることに注意して、$X$の部分空間として

$$
X_j = \operatorname{Span}\lbrace \Phi_F^i (H_j) \mid i = 0, \ldots, T-1, j = 1, \ldots, M \rbrace
$$

と定める。すると任意の

$$
f = \sum_{i=0}^{T-1} a_i \Phi_F^i(H_j) \in X_j
$$

について

$$
f(z_0) = \sum_{i=0}^{T-1} a_i x_{ij}
$$

が成り立つ。
