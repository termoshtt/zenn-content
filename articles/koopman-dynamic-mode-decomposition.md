---
title: "å‹•çš„ãƒ¢ãƒ¼ãƒ‰åˆ†è§£(DMD)ã¨Koopmanä½œç”¨ç´ "
emoji: "ðŸ“¦"
type: "idea"
topics: ["math"]
published: true
---

ã“ã®è¨˜äº‹ã§ã¯æ™‚ç³»åˆ—è§£æžã®æ‰‹æ³•ã®ä¸€ã¤ã§ã‚ã‚‹å‹•çš„ãƒ¢ãƒ¼ãƒ‰åˆ†è§£(Dynamic mode decomposition, DMD)ã‚’Koopmanä½œç”¨ç´ ã¨ã®é–¢ä¿‚ã‚’ä¸­å¿ƒã«è§£èª¬ã™ã‚‹ã€‚

çŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«
------------
ã¾ãšè§£æžã®å‰æã¨ãªã‚‹è¨­å®šã«ã¤ã„ã¦ã¾ã¨ã‚ã¦ã„ãã€‚ã“ã®è¨˜äº‹ã§ã¯ã‚ã‚‹ä¸€å®šã®æ™‚é–“é–“éš”($\Delta t$ã¨æ›¸ã)ã§ã€æœ‰é™å€‹(ä»¥é™$N$ã¨ã™ã‚‹)ã®å®Ÿæ•°å€¤ã®ãƒ‡ãƒ¼ã‚¿ãŒå¾—ã‚‰ã‚Œã‚‹ã‚·ã‚¹ãƒ†ãƒ ã‚’è€ƒãˆã€ãã®æŒ™å‹•ã‚’è§£æžã—ãŸã„ã¨ã™ã‚‹ã€‚å„æ™‚åˆ»$t_i = i \Delta t$, $i = 0, \ldots, T$ã«å¯¾ã—ã¦å¾—ã‚‰ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’$x_i \in \mathbb{R}^N$ã¨æ›¸ãã€‚ã¾ãŸã‚·ã‚¹ãƒ†ãƒ ã®çŠ¶æ…‹ã‚’è¡¨ã™å…¨ã¦ã®å¤‰æ•°ã‚’è¦³æ¸¬ã§ãã‚‹ã¨ã¯é™ã‚‰ãªã„ã®ã§ã€å„æ™‚åˆ»$t_i$ã«ãŠã‘ã‚‹çœŸã®çŠ¶æ…‹ã‚’$z_i$ã¨æ›¸ãã€ãã“ã‹ã‚‰$x_i$ã‚’ç”Ÿæˆã™ã‚‹éŽç¨‹ã‚’è¦³æ¸¬ã¨å‘¼ã³$x_i = H(z_i)$ã¨æ›¸ãã“ã¨ã«ã—ã‚ˆã†ã€‚è¦³æ¸¬ã«å¯¾å¿œã™ã‚‹é–¢æ•°$H$ãŒ$i$ã«ä¾å­˜ã—ãªã„ã®ã¯è¦³æ¸¬ã®æ–¹æ³•ã¯æ™‚åˆ»ã«ä¾å­˜ã—ãªã„ã“ã¨ã‚’æ„å›³ã—ã¦ã„ã‚‹ã€‚

çœŸã®çŠ¶æ…‹$z_i$ãŒã²ã¨ã¤å‰ã®çŠ¶æ…‹$z_{i-1}$ã«ã‚ˆã£ã¦ã ã‘å®šã¾ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã®ã“ã¨ã‚’ãƒžãƒ«ã‚³ãƒ•çš„ã§ã‚ã‚‹ã¨ã„ã†ã€‚ã“ã®é–¢ä¿‚ã‚’$z_i = F(z_{i-1})$ã¨æ›¸ãã€‚$f$ã‚’æ™‚é–“ç™ºå±•ã¨å‘¼ã³ã€ã“ã‚Œã‚‚æ™‚åˆ»ã«ä¾ã‚‰ãªã„ã¨ä»®å®šã™ã‚‹ã€‚ç‰©ç†çš„ãªç³»ã«ãŠã„ã¦ã¯æ™‚é–“ç™ºå±•ã¯æ™‚é–“ã«é–¢ã™ã‚‹å¾®åˆ†æ–¹ç¨‹å¼ã§ä¸Žãˆã‚‰ã‚Œã‚‹(ã“ã‚Œã‚’é‹å‹•æ–¹ç¨‹å¼ã¨å‘¼ã¶)äº‹ãŒå¤šã„ãŒã€é©å½“ãªæ™‚é–“é–“éš”ã«ã¤ã„ã¦ç©åˆ†ã™ã‚‹ã“ã¨ã§ã“ã®å½¢ã«ãªã‚‹ã€‚ã“ã®$z_i$ãŒå±žã™ã‚‹ãƒŽãƒ«ãƒ ç·šå½¢ç©ºé–“ã‚’$V$ã¨æ›¸ãçŠ¶æ…‹ç©ºé–“ã¨å‘¼ã¶ã“ã¨ã«ã—ã‚ˆã†ã€‚ã“ã‚Œã‚‚æ™‚åˆ»ã«ã¯ä¾ã‚‰ãªã„ã€ã‚ã‚‹ã„ã¯å…¨ã¦ã®æ™‚åˆ»ã«ã¤ã„ã¦å†…åŒ…ã§ãã‚‹ã‚ˆã†ã«$V$ã‚’å–ã‚Œã‚‹ã¨ä»®å®šã™ã‚‹ã€‚ã•ã‚‰ã«$F: V \to V$ãŠã‚ˆã³$H: V \to \mathbb{R}^N$ã¯é€£ç¶šã§ã‚ã‚‹ã¨ä»®å®šã™ã‚‹ã€‚

ã•ã‚‰ã«è§£æžã—ãŸã„ã‚·ã‚¹ãƒ†ãƒ ã¯å®šå¸¸çš„ã§ã‚ã‚‹ã¨ä»®å®šã™ã‚‹ã€‚ã“ã®æ™‚çŠ¶æ…‹ç©ºé–“ã®éƒ¨åˆ†é›†åˆ$A \subset V$ã¨ã—ã¦$F$ã§ä¸å¤‰ãªé›†åˆ

$$
F(A) = A
$$

ã¨ãªã‚‹é›†åˆãŒå–ã‚Œã‚‹ã€‚ä¾‹ãˆã°ãƒªãƒŸãƒƒãƒˆã‚µã‚¤ã‚¯ãƒ«ã‚’ç¤ºã™åŠ›å­¦ç³»ã‚’ä¸€å®šã®æ™‚é–“é–“éš”ã§ç©åˆ†ã—ãŸã‚·ã‚¹ãƒ†ãƒ ã§ã¯$A$ã¯ãã®ãƒªãƒŸãƒƒãƒˆã‚µã‚¤ã‚¯ãƒ«ã«ãªã‚Šã€ãƒ­ãƒ¼ãƒ¬ãƒ³ãƒ„ãƒ¢ãƒ‡ãƒ«ã®ã‚ˆã†ãªå ´åˆã«ã¯$A$ã¯ã‚«ã‚ªãƒ†ã‚£ãƒƒã‚¯ã‚¢ãƒˆãƒ©ã‚¯ã‚¿ã¨ãªã‚‹ã€‚ã“ã®ã‚ˆã†ãª$A$ã‚’ä¸å¤‰é›†åˆã¨å‘¼ã¶ã€‚

Koopmanä½œç”¨ç´ 
-------------
æ™‚é–“ç™ºå±•$F: V \to V$ã‚’è§£æžã™ã‚‹ã“ã¨ãŒç›®çš„ã ãŒã€ã“ã‚Œã¯éžç·šå½¢ãªé–¢æ•°ãªã®ã§ãã®ã¾ã¾ã ã¨è§£æžãŒé›£ã—ã„ã€‚ãã“ã§å°‘ã—ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«ãªæ–¹æ³•ã§ç·šå½¢ä½œç”¨ç´ ã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ã«å¤‰æ›ã™ã‚‹ã€‚

ä¸å¤‰é›†åˆ$A$ã®$V$ã§ã®é–‰åŒ…$\bar{A}$ã«ãŠã‘ã‚‹é€£ç¶šé–¢æ•°å…¨ä½“

$$
X = \operatorname{Hom}(\bar{A}, \mathbb{R}) = \lbrace f: \bar{A} \to \mathbb{R}; \text{é€£ç¶š} \rbrace
$$

ã‚’è€ƒãˆã‚‹ã¨ã€ã“ã‚Œã«ã¯$f, g \in X$ã¨ã‚¹ã‚«ãƒ©ãƒ¼$a \in \mathbb{R}$ã«å¯¾ã—ã¦æ–°ã—ã„é–¢æ•°$f + g, af \in X$ã‚’å„$z \in \bar{A}$ã«å¯¾ã—ã¦

$$
(f + g)(z) = f(z) + g(z), \space (af)(z) = a f(z)
$$

ã§å®šç¾©ã™ã‚‹ã“ã¨ã§ç·šå½¢ç©ºé–“ã¨ãªã‚‹ã€‚

ã“ã®é–¢æ•°ç©ºé–“ã«ã¯æ¬¡ã®ã‚ˆã†ã«å†…ç©ãŒå…¥ã‚‹ã€‚é©åˆ‡ãªä»®å®šã®å…ƒã§ä»»æ„ã®$f \in X$ã«å¯¾ã—ã¦

$$
\int f(z) d\mu(z) = \lim_{T \to \infty} \frac{1}{T} \sum_{i=1}^T f(F^i(z_0))
$$

ãŒã»ã¨ã‚“ã©ã™ã¹ã¦ã®$z_0$ã«ã¤ã„ã¦æˆã‚Šç«‹ã¤ã‚ˆã†ãª$A$ä¸Šã®ç¢ºçŽ‡æ¸¬åº¦$\mu$ãŒå­˜åœ¨ã™ã‚‹ã“ã¨ãŒçŸ¥ã‚‰ã‚Œã¦ãŠã‚Šã€ã“ã®æ¸¬åº¦ã¯éƒ¨åˆ†é›†åˆ$B \subset A$ã«ã¤ã„ã¦

$$
\mu(F^{-1}(B)) = \mu(B)
$$

ã‚’æº€ãŸã™ã®ã§$F$-ä¸å¤‰ç¢ºçŽ‡æ¸¬åº¦ã¨å‘¼ã°ã‚Œã‚‹ã€‚ã“ã‚Œã‚’ä½¿ã£ã¦$f, g \in X$ã«å¯¾ã—ã¦å†…ç©ã‚’

$$
(f, g) = \int f(z) g(z) d\mu(z)
$$

ã¨å®šã‚ãƒŽãƒ«ãƒ ã‚’$\| f \| = \sqrt{(f, f)}$ã¨ã™ã‚‹ã€‚

ã‚ã‚‹$f \in X$ã«å¯¾ã—ã¦ã€æ™‚é–“ç™ºå±•$F: V \to V$ã‚’å³ã‹ã‚‰ä½œç”¨ã•ã›ãŸé–¢æ•°$f \circ F$ã‚’è€ƒãˆã‚‹ã¨ã“ã‚Œã¯å†ã³$X$ã®å…ƒã«ãªã‚Šã€$f, g \in X$ã¨$z \in V$ã«ã¤ã„ã¦

$$
\begin{align*}
((f+g) \circ F)(z) &= (f+g)(F(z)) \\
& = f(F(z)) + g(F(z)) \\
&= (f \circ F)(z) + (g \circ F)(z) = (f \circ F + g \circ F)(z)
\end{align*}
$$

ãªã®ã§$f \mapsto f \circ F$ã¯$X$ã®ç·šå½¢ç©ºé–“ã®æ§‹é€ ã«ã¤ã„ã¦ç·šå½¢ã¨ãªã‚Šã€ã“ã®ç·šå½¢å†™åƒã‚’$\Phi_F: X \to X$ã¨æ›¸ãã€‚ã•ã‚‰ã«ä¸Šã®å†…ç©ã‚ˆã‚Šå®šã¾ã‚‹ãƒŽãƒ«ãƒ ã«å¯¾ã—ã¦$\Phi_F$ã¯ç­‰é•·çš„ã€ã¤ã¾ã‚Š $\| \Phi_F(f) \| = \| f \|$ãŒæˆã‚Šç«‹ã¤ã€‚

å‹•çš„ãƒ¢ãƒ¼ãƒ‰åˆ†è§£
--------------
ã•ã¦è¦³æ¸¬ãƒ‡ãƒ¼ã‚¿$x_i$ã‹ã‚‰ç·šå½¢å†™åƒ$\Phi_F$ã‚’å›žå¸°ã™ã‚‹ã“ã¨ã‚’è€ƒãˆã‚ˆã†ã€‚

ã¾ãšæ³¨æ„ã—ãªã„ã¨ã„ã‘ãªã„ã®ã¯$V$ãŒæœ‰é™æ¬¡å…ƒã§ã‚ã£ã¦ã‚‚$X$ã¯ç„¡é™æ¬¡å…ƒã«ãªã‚‹ã“ã¨ã§ã‚ã‚‹ã€‚$\Phi_F$ã¯$X$ä¸Šã®ç·šå½¢å†™åƒãªã®ã§ä¸€èˆ¬ã«è¡Œåˆ—ã§ã¯è¡¨ç¾ã§ããšã€ãªã®ã§è¨ˆç®—æ©Ÿã§è¡¨ç¾ã§ãã‚‹ã¨ã¯é™ã‚‰ãªã„ã€‚æ•°å­¦çš„ã«ã¯$F$ãŒã©ã®ã‚ˆã†ãªæ€§è³ªã‚’æŒã¤ã¨ãã«é©å½“ãª$\Phi_F$ã®è¿‘ä¼¼ãŒå¯èƒ½ã«ãªã‚‹ã®ã‹ã‚’è€ƒãˆã‚‹ã¹ãã ãŒã€å¿œç”¨ä¸Šã¯$\Phi_F$ã‚’ã¨ã‚Šã‚ãˆãšé©å½“ãª$X$ã®éƒ¨åˆ†ç©ºé–“ä¸Šã§è©•ä¾¡ã—ã¦ã¿ã¦ã©ã®ç¨‹åº¦$F$ã®æƒ…å ±ã‚’å–ã‚Šå‡ºã›ãŸã®ã‹ã‚’èª¿ã¹ã‚‹ã€‚

$X$ã®éƒ¨åˆ†ç©ºé–“ã¨ã—ã¦ã€ä½•ã‹ä¸€ã¤$f \in X$ã‚’å›ºå®šã—ã¦ã“ã‚Œã‚’$\Phi_F$ã«ã‚ˆã£ã¦åå¾©ã™ã‚‹ã¨

$$
f, \Phi_F(f), \Phi_F^2(f), \ldots
$$

ã¨ã„ã†åˆ—ãŒã§ãã‚‹ã“ã¨ã‚’åˆ©ç”¨ã—ã€ã“ã‚Œã‚’é †ç•ªã«ç›´äº¤åŒ–ã™ã‚‹ã“ã¨ã§éƒ¨åˆ†ç©ºé–“ã‚’ä½œã£ã¦ã„ãã€‚ã¤ã¾ã‚Šã¾ãš$f_0 = f / \| f \|$ã¨å®šã‚ã€

$$
\begin{align*}
  g_{j+1} &= \Phi_F(f_j) \\
  l_{j+1} &= g_{j+1} - \sum_{k=0}^j (f_k, g_{j+1}) f_k \\
  f_{j+1} &= l_{j+1} / \| l_{j+1} \|
\end{align*}
$$

ã«ã‚ˆã£ã¦äº’ã„ã«ç›´äº¤ã™ã‚‹è¦æ ¼åŒ–ã•ã‚ŒãŸãƒ™ã‚¯ãƒˆãƒ«$f_j \in X$ã‚’ç”Ÿæˆã—ã¦ã„ãã€‚ãŸã ã—é€”ä¸­ã§$l_{j+1} = 0$ã«ãªã£ãŸã¨ãã¯$f_j$ã¾ã§ã§æ­¢ã‚ã‚‹ã“ã¨ã«ã™ã‚‹ã€‚
ã“ã‚Œã‚‰ã‚’åŸºåº•ã¨ã™ã‚‹ç©ºé–“

$$
X^j(f) = \operatorname{Span}\lbrace f_0, \ldots, f_{j-1} \rbrace \subset X
$$

ã‚’è€ƒãˆã‚‹ã¨$X^{j+1}(f)$ãŒå­˜åœ¨ã™ã‚‹æ™‚ã“ã‚Œã¯æ§‹æˆã‚ˆã‚Šæ˜Žã‚‰ã‹ã« $\Phi_F(X^j(f)) \subset X^{j+1}(f)$ ã‚’æº€ãŸã™ã®ã§ã€ã“ã‚Œã‚’$f_j$ã‚’æ¨ªã«ä¸¦ã¹ã‚‹ã“ã¨ã§è¡Œåˆ—ã®ã‚ˆã†ã«æ›¸ãã¨

$$
\Phi_F \left(f_0 \cdots f_{j-1} \right) = \left(f_0 \cdots f_j \right)
\begin{pmatrix}
    * & \cdots & \cdots & * \\
    * & \cdots & \cdots & * \\ 
    0 & *      & \cdots & * \\
    \vdots & \ddots & \ddots & \vdots \\
    0 & \cdots & 0      & *
\end{pmatrix}
$$

ã¨æ›¸ã‘ã‚‹ã€‚ã“ã®å³è¾ºã®ä¿‚æ•°è¡Œåˆ—ã‚’$\Psi_F$ã¨æ›¸ãã“ã¨ã«ã™ã‚‹ã€‚ã“ã‚Œã¯ä¸Šä¸‰è§’è¡Œåˆ—ã«ã‚‚ã†ä¸€åˆ—è¶³ã—ãŸã‚‚ã®ã§Hessenbergè¡Œåˆ—ã¨å‘¼ã°ã‚Œã‚‹ã€‚ã“ã®ã‚ˆã†ã«æ¼”ç®—å­ãŒã‚ã‚‹æ™‚ã«ä¸€ã¤ã®ãƒ™ã‚¯ãƒˆãƒ«ã«å¯¾ã™ã‚‹åå¾©ã‚’ç›´äº¤åŒ–ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦åŸºåº•ã‚’ä½œã‚Šã€ãã®åŸºåº•ã®ãªã™éƒ¨åˆ†ç©ºé–“ã§æ¼”ç®—å­ã‚’Hessenbergè¡Œåˆ—ã¨ã—ã¦è¡¨ç¾ã™ã‚‹æ‰‹æ³•ã¯ç–Žè¡Œåˆ—ã®åå¾©è§£æ³•ã®ä¸€ã¤ã¨ã—ã¦Arnoldiæ³•ã¨çŸ¥ã‚‰ã‚Œã¦ã„ã‚‹ã€‚ä¿‚æ•°ã®çµ„ã‹ã‚‰$X^j(f)$ã®å…ƒã‚’å®šã‚ã‚‹å†™åƒ

$$
\psi_j: \mathbb{R}^j \ni (a_0, \ldots, a_{j-1}) \longmapsto \sum_{k=0}^{j-1} a_k f_k \in X^j(f)
$$

ã‚’è€ƒãˆã‚‹ã¨ã€ä¸Šã®è¡Œåˆ—$\Psi_F$ã¯æ¬¡ã®å›³å¼ã‚’å¯æ›ã«ã™ã‚‹ã‚ˆã†ã«ä½œã£ã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚‹

$$
\begin{CD}
   V^j(f) @>{\Phi_F}>> V^{j+1}(f) \\
   @A{\psi_j}AA  @AA{\psi_{j+1}}A \\
   \mathbb{R}^j @>{\Psi_F}>> \mathbb{R}^{j+1}
\end{CD}
$$